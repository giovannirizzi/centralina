Tutti i dispositivi anche la centralina hanno:
    un id
    uno stato
    dei registri
    degli interruttori.
    
I dispositivi di controllo hanno in più anche una lista pipe per parlare con i figli.
    
La centralina è un dispositivo di controllo come gli altri lei però prende i comandi da shell
anziche tramite pipe. In realtà ogni dispositivo prende comandi da stdin e risponde in stdout
però quando si aggiunge un dispositivo ad uno di controllo, l'stdin e stdout  del dispositivo saranno pipe
collegate al dispositivo di controllo parent. Il vantaggio è che si può eseguire il singolo dispositivo da shell
e impartire comandi testuali.

COMANDI DA IMPLEMENTARE:

dispositivi di iterazione:
    stdin (richiesta)                   stdout (risposta)
    
    whois <id>                          il suo PID se è il dispositivo <id>, -1 altrimenti oppure non risponde..
    info <id>                           se è il dispositivo <id> rest. le sue info, altrimenti errore o niente
    info                                restituisce le sue info sempre
    del <id>                            se è <id> termina l'esecuzione, la risposta niente o boh..
    switch <id> <interruttore> <pos>    se è <id> switch l'interrutore, la risposta boh...
    switch <interrutore <pos>
    del                                 termina l'esecuzione, la risposta niente o boh..
    
    set <configurazione>                setta lo stato e i registri del processo in base alla configurazione
    get                                 ricava le informazioni (configurazione) del dispositivo.

dispositivi di controllo:
    stdin (richiesta)                   stdout (risposta)
    
    tutti i comandi dispositivi di iterazione
    
    link <id> to <id>
    add <configurazione>               Aggiunge un dispositivo con la configurazione passata come parametro
    
    la configurazione può essere anche un intero albero di dispositivi
    
centralina:
    oltre a quelli di controllo anche:
    
    add <device name>
    
    
Ci sono 2 versioni per ogni comando una con <id> e l'altra senza, perché il dispositivo di controllo
che controlla il dispositivo di iterazione non conosce il suo id (lui ha solo il canale per comunicare, pipe).
Almeno io l'ho interpretata così. Quindi se un hub vuole le info dei sui filgi chiama la info su tutti i figli, se la centralina vuole le info dell'id 1 invia in brodcast ai figli e risponde solo l'id 1.

Al posto di settare un dispositivo via parametri del main pensavo di fare un comando apposta del tipo:
set <id> state=<on/off> registry:time=2&bo=3 (gli interruttori non hanno dati o no?)

La roba peso sarà implementare la struttura della risposta al comando get di un dispositivo di controllo perché
deve restituire tutto l'albero.

Centralina:
    Segnali:
        per interruttore generale forse?
    Comandi:
        non deve eseguire comandi
    Registro:
        num: numero di dispositivi direttamente connessi
    Args per inizializzazione
        nessuno
    Stato:
        on/off
    interruttore:
        generale on/off, cosa fa? invia power off/on a tutti i collegati?, viene modificato al comando switch 
        

Bulb:
    Segnali: 
        1 segnale per on/off stato
    Comandi:
        interruttori: 
            set on/off interruttore -> da risposta??
        get info -> da in risposta info
        delete?
    Registro
        time: tempo di utilizzo. come lo calcolo??
    Args per inizializzazione:  
        id ?? per named pipe eventualmente
        stato
        registro
        
Hub:
    Segnali: 
        no iterazioni al di fuori della centralina...? fa il mirroring degli interruttori...
    Comandi:
        interruttori: 
            boh fa il mirroring, tutti i comandi che riceve li invia ha i figli?
        get info -> da in risposta info anche in base hai figli
        delete? penso di si perché deve eliminare ricorsivamente i figli
        link per collegare altri dispositivi
    Registro:
        mirroring dei figli, cosa vuol dire??
    Stato:
        mirroring dei filgi, lo calcola on/off con ovverride eventualmente
    Args per inizializzazione:
        id per le pipe?
        e basta perché è tutto un mirroring
    
Windows:
    
    Segnali: 
        1  per aprire
        1 per chiudere
    Comandi:
        interruttori: 
            set open on/off
            set close on/off
        get info -> da in risposta info
        delete?
    Registro
        time: tempo di utilizzo. come lo calcolo??
    Args per inizializzazione:
        id ?? per named pipe eventualmente
        stato
        registro
        
Frigo:
    Segnali: 
        1 segnale per on/off stato
        1 segnale per aggiungere e togliere contenuto!?
        1 impostare termostato
    Comandi:
        interruttori: 
            set on/off interruttore
            set temp valore
        get info -> da in risposta info
        delete?
    Registro
        time: tempo di apertura. come lo calcolo?
        ​delay​ = tempo dopo cui si richiude automaticamente (la posso modificare)
​        perc​ = percentuale di riempimento (la modifico solo con intervento manuale)
​        temp​ = temperatura interna

    Args per inizializzazione:
        id ?? per named pipe eventualmente
        stato
        registro
        
Timer:
    boh, no si capisce...
        
        
