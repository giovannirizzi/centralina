Alla fine molto probabilmente la add <device> crea il device e lo linka anche alla centralina.

I dispositivi collegati alla centralina penso che parleranno con le pipe (normali o named???).
La centralina comunica direttamente ai dispositivi non collegati direttamente ad essa???? es centralina - hub - bulb

Centralina:
    Funzioni da implementare:
        list():
        add_device(char* device): in base al tipo di device farà la fork e la exec(./bulb) o exec(./device bulb) 
                                    corrispondente al device passato come parametro. Ci sarà una serie di
                                    if(strcmp("bulb",device) == ). Al device appena creato bisogna assegnare anche un id.
        
        delete_device(int device_id): controlla se il device_id è un id valido, se si, rimuove il device dai device attivi e killa i 
                                        processi dei device mandando un signal o boh...
                                        
        link_devices(int device_id_1, int device_id_2): è abbastanza complicata questa boh...

        switch_device(int device_id, char* label_interruttore, char* pos): anche questa complicata l'interruttore ha anche un label
                                                                            nel pdf quello della finestra è open ma ad esempio quello della lampadina
                                                                            sarà diverso. la funzione penso che userà le pipe per switchare il device
        get_info(int device_id): interroga il device, probabilmente con le pipe...
        
        
Un eseguibile es. manualcontrol che simula i comandi manuali dei dispositivi senza passare per la centralina.
Si utilizzeranno gli args del main come comandi per switchare lo stato dei device manualmente.
Il manualcontrol userà i segnali per comunicare con i processi dei devices quindi bisogna sapere i loro PID.

la get info serve anche per ricavare le info del dispositivo per ricostruirlo se cambia parent. (comando link)
Si usa lo stesso comando o un comando uno a parte???? le informazioni restituite si passeranno come args al nuovo processo
per settarlo come prima.



COMANDI DA IMPLEMENTARE:

dispositivi di iterazione:
    stdin (richiesta)                   stdout (risposta)
    
    whois <id>                          il suo PID se è il dispositivo <id>, -1 altrimenti oppure non risponde..
    info <id>                           se è il dispositivo <id> rest. le sue info, altrimenti errore o niente
    info                                restituisce le sue info sempre
    del <id>                            se è <id> termina l'esecuzione, la risposta niente o boh..
    switch <id> <interruttore> <pos>    se è <id> switch l'interrutore, la risposta boh...
    switch <interrutore <pos>
    del                                 termina l'esecuzione, la risposta niente o boh..
    dovrebbero essere tutti...
    
Ci sono 2 versioni per ogni comando una con <id> e l'altra senza, perché il dispositivo di controllo
che controlla il dispositivo di iterazione non conosce il suo id (lui ha solo il canale per comunicare, pipe).
Almeno io l'ho interpretata così. Quindi se un hub vuole le info dei sui filgi chiama la info su tutti i figli, se la centralina vuole le info dell'id 1 invia in brodcast ai figli e risponde solo l'id 1.

Al posto di settare un dispositivo via parametri del main pensavo di fare un comando apposta del tipo:
set <id> state=<on/off> registry:time=2&bo=3 (gli interruttori non hanno dati o no?)

La roba peso sarà implementare la struttura della risposta al comando info di un dispositivo di controllo perché
deve restituire tutto l'albero.






Centralina:
    Segnali:
        per interruttore generale forse?
    Comandi:
        non deve eseguire comandi
    Registro:
        num: numero di dispositivi direttamente connessi
    Args per inizializzazione
        nessuno
    Stato:
        on/off
    interruttore:
        generale on/off, cosa fa? invia power off/on a tutti i collegati?, viene modificato al comando switch 
        

Bulb:
    Segnali: 
        1 segnale per on/off stato
    Comandi:
        interruttori: 
            set on/off interruttore -> da risposta??
        get info -> da in risposta info
        delete?
    Registro
        time: tempo di utilizzo. come lo calcolo??
    Args per inizializzazione:  
        id ?? per named pipe eventualmente
        stato
        registro
        
Hub:
    Segnali: 
        no iterazioni al di fuori della centralina...? fa il mirroring degli interruttori...
    Comandi:
        interruttori: 
            boh fa il mirroring, tutti i comandi che riceve li invia ha i figli?
        get info -> da in risposta info anche in base hai figli
        delete? penso di si perché deve eliminare ricorsivamente i figli
        link per collegare altri dispositivi
    Registro:
        mirroring dei figli, cosa vuol dire??
    Stato:
        mirroring dei filgi, lo calcola on/off con ovverride eventualmente
    Args per inizializzazione:
        id per le pipe?
        e basta perché è tutto un mirroring
    
Windows:
    
    Segnali: 
        1  per aprire
        1 per chiudere
    Comandi:
        interruttori: 
            set open on/off
            set close on/off
        get info -> da in risposta info
        delete?
    Registro
        time: tempo di utilizzo. come lo calcolo??
    Args per inizializzazione:
        id ?? per named pipe eventualmente
        stato
        registro
        
Frigo:
    Segnali: 
        1 segnale per on/off stato
        1 segnale per aggiungere e togliere contenuto!?
        1 impostare termostato
    Comandi:
        interruttori: 
            set on/off interruttore
            set temp valore
        get info -> da in risposta info
        delete?
    Registro
        time: tempo di apertura. come lo calcolo?
        ​delay​ = tempo dopo cui si richiude automaticamente (la posso modificare)
​        perc​ = percentuale di riempimento (la modifico solo con intervento manuale)
​        temp​ = temperatura interna

    Args per inizializzazione:
        id ?? per named pipe eventualmente
        stato
        registro
        
Timer:
    boh, no si capisce...
        
        
